---------<테이블 모음>------

------멤버--------
CREATE TABLE member (
    mid VARCHAR2(50) NOT NULL,
    pw VARCHAR2(100) NOT NULL,
    mname VARCHAR2(50) NOT NULL,
    maddr VARCHAR2(150) NOT NULL,
    memail VARCHAR2(100) NOT NULL,
    mphone VARCHAR2(100) NOT NULL,
    mdate DATE DEFAULT SYSDATE NULL
);
ALTER TABLE member ADD CONSTRAINT PK_MEMBER PRIMARY KEY (
    mid
);


--멤버권한--
CREATE TABLE memberAuth (
    mid VARCHAR2(50) NOT NULL,
    auth VARCHAR2(50) NOT NULL,
    CONSTRAINT fk_memberAuth
        FOREIGN KEY (mid)
        REFERENCES member(mid)
	ON DELETE CASCADE
);


-----리멤버미----
CREATE TABLE PERSISTENT_LOGINS (	
	SERIES VARCHAR2(64 BYTE), 
    	USERNAME VARCHAR2(64 BYTE) NOT NULL ENABLE, 
	TOKEN VARCHAR2(64 BYTE) NOT NULL ENABLE, 
	LAST_USED TIMESTAMP (6) NOT NULL ENABLE, 
	PRIMARY KEY (SERIES));


-----견적상담-----
CREATE TABLE consult (
    consultNo NUMBER NOT NULL,
    mid VARCHAR2(50) NOT NULL,
    mphone VARCHAR2(50) NOT NULL,
    postcode VARCHAR2(50) NOT NULL,
    address VARCHAR2(100) NOT NULL,
    detailAddress VARCHAR2(100) NOT NULL,
    buildingType VARCHAR2(100) NOT NULL,
    scheduledDate VARCHAR2(50) NOT NULL,
    budget NUMBER NOT NULL,
    pyeongsu NUMBER NOT NULL,
    happyCall VARCHAR2(100) NOT NULL,
    consultDate DATE DEFAULT SYSDATE NOT NULL,
    status VARCHAR2(100) NOT NULL
);
ALTER TABLE consult ADD CONSTRAINT PK_CONSULT PRIMARY KEY (
    consultNo
);
ALTER TABLE consult ADD CONSTRAINT FK_member_TO_consult_1 FOREIGN KEY (
    mid
)
REFERENCES member (
    mid
)
ON DELETE CASCADE
;


-------견적서------
CREATE TABLE quotation (
    quoNo NUMBER NOT NULL,
    itemNo NUMBER NOT NULL,
    consultNo NUMBER NOT NULL,
    quoDate DATE DEFAULT SYSDATE NOT NULL,
    constScheduleStart DATE NOT NULL,
    constScheduleEnd DATE NOT NULL,
    constTotal NUMBER NOT NULL,
    demolTotal NUMBER NOT NULL,
    total NUMBER NOT NULL
);
ALTER TABLE quotation ADD CONSTRAINT PK_QUOTATION PRIMARY KEY (
    quoNo
);
ALTER TABLE quotation ADD CONSTRAINT FK_consult_TO_quotation_1 FOREIGN KEY (
    consultNo
)
REFERENCES consult (
    consultNo
)
ON DELETE CASCADE
;


-----공지사항------
CREATE TABLE notice (
    notNo NUMBER NOT NULL,
    mid VARCHAR2(50) NOT NULL,
    notCategory VARCHAR2(50) NOT NULL,
    notTitle VARCHAR2(999) NOT NULL,
    notCont VARCHAR2(999) NOT NULL,
    notHit NUMBER NOT NULL,
    notDate DATE DEFAULT SYSDATE NOT NULL
);
ALTER TABLE notice ADD CONSTRAINT PK_NOTICE PRIMARY KEY (
    notNo
);
ALTER TABLE notice ADD CONSTRAINT FK_member_TO_notice_1 FOREIGN KEY (
    mid
)
REFERENCES member (
    mid
);
--공지사항첨부파일---
CREATE TABLE noticeAttach (
    uuid VARCHAR2(100) NOT NULL,
    notNo NUMBER NOT NULL,
    upfolder VARCHAR2(200) NOT NULL,
    filename VARCHAR2(100) NOT NULL,
    image CHAR(1) NULL
);
ALTER TABLE noticeAttach ADD CONSTRAINT PK_NOTICEATTACH PRIMARY KEY (
    uuid
);
ALTER TABLE noticeAttach ADD CONSTRAINT FK_notice_TO_noticeAttach_1 FOREIGN KEY (
    notNo
)
REFERENCES notice (
    notNo
);


--------시공&철거항목---------
CREATE TABLE item (
    itemNo NUMBER NOT NULL,
    consultNo NUMBER NOT NULL,
    tiling NUMBER NULL,
    tilingD NUMBER NULL,
    flooring NUMBER NULL,
    flooringD NUMBER NULL,
    kitchen NUMBER NULL,
    kitchenD NUMBER NULL,
    bathroom NUMBER NULL,
    bathroomD NUMBER NULL,
    entrance NUMBER NULL,
    entranceD NUMBER NULL,
    balcony NUMBER NULL,
    balconyD NUMBER NULL,
    lighting NUMBER NULL,
    lightingD NUMBER NULL,
    door NUMBER NULL,
    doorD NUMBER NULL,
    etc NUMBER NULL,
    etcD NUMBER NULL
);
ALTER TABLE item ADD CONSTRAINT PK_ITEM PRIMARY KEY (
    itemNo
);
ALTER TABLE item
ADD CONSTRAINT FK_consult_TO_item_1
FOREIGN KEY (consultNo)
REFERENCES consult(consultNo)
ON DELETE CASCADE;


-----------방문일정------------
CREATE TABLE visit (
    visitNo NUMBER NOT NULL,
    consultNo NUMBER NOT NULL,
    visitStatus VARCHAR2(100) NULL,
    visitDateStart DATE NULL,
    visitDateEnd DATE NULL
);
ALTER TABLE visit ADD CONSTRAINT PK_VISIT PRIMARY KEY (
    visitNo
);
ALTER TABLE visit ADD CONSTRAINT FK_consult_TO_visit_1 FOREIGN KEY (
    consultNo
)
REFERENCES consult (
    consultNo
)
ON DELETE CASCADE;	

-----추가 FK 견적서-아이템 -------
ALTER TABLE quotation ADD CONSTRAINT FK_item_TO_quotation_1 FOREIGN KEY (
    itemNo
)
REFERENCES item (
    itemNo
)
ON DELETE CASCADE
;

----------시공의뢰----------
CREATE TABLE sireq (
    sireqNo NUMBER,
    quoNo NUMBER,
    itemNo NUMBER,
    consultNo NUMBER,
    mid VARCHAR2(50),
    mname VARCHAR2(50),
    sireqDate DATE DEFAULT SYSDATE,
    sigongTotal NUMBER,
    sireqStatus VARCHAR2(30) DEFAULT '의뢰접수',
    payStatus VARCHAR2(30) DEFAULT '계약금미납',
    sireqUpdateDate DATE DEFAULT SYSDATE
);

ALTER TABLE sireq ADD CONSTRAINT PK_SIREQ PRIMARY KEY (
	sireqNo
);
ALTER TABLE sireq ADD CONSTRAINT FK_quotation_TO_sireq_1 FOREIGN KEY (
	quoNo
)
REFERENCES sireq (
	quoNo
) ON DELETE CASCADE;
ALTER TABLE sireq ADD CONSTRAINT FK_item_TO_sireq_1 FOREIGN KEY (
	itemNo
)
REFERENCES item (
	itemNo
) ON DELETE CASCADE;
ALTER TABLE sireq ADD CONSTRAINT FK_consult_TO_sireq_1 FOREIGN KEY (
    consultNo
)
REFERENCES consult (
    consultNo
)
ON DELETE CASCADE
;
ALTER TABLE sireq ADD CONSTRAINT FK_member_TO_sireq_1 FOREIGN KEY (
	mid
)
REFERENCES member (
	mid
) ON DELETE CASCADE;
------시공의뢰 첨부파일-------
CREATE TABLE sireqAttach (
	uuid	VARCHAR2(100),
	sireqNo	NUMBER,
	upFolder	VARCHAR2(200),
	fileName	VARCHAR2(100),
	image	CHAR(1 )
);
ALTER TABLE sireqAttach ADD CONSTRAINT PK_SIREQATTACH PRIMARY KEY (
	uuid
);
ALTER TABLE sireqAttach ADD CONSTRAINT FK_sireq_TO_sireqAttach_1 FOREIGN KEY (
	sireqNo
)
REFERENCES sireq (
	sireqNo
) ON DELETE CASCADE;


-----------시공팀스케줄관리-------
CREATE TABLE siche (
	sicheNo	NUMBER	NOT NULL,
	sireqNo	NUMBER	NOT NULL,
	quoNo	NUMBER	NOT NULL,
	mid	VARCHAR2(50)	NOT NULL,
	startDate	DATE	DEFAULT SYSDATE NOT NULL,
	endDate		DATE NOT NULL,
	balanceStatus	VARCHAR2(30) DEFAULT '잔금처리대기' NOT NULL,
	constructionStatus	VARCHAR2(30) DEFAULT '착수전' NOT NULL,
	workCrew	VARCHAR2(20)	NOT NULL
);
ALTER TABLE siche ADD CONSTRAINT PK_SICHE PRIMARY KEY (
	sicheNo
);
ALTER TABLE siche ADD CONSTRAINT FK_sireq_TO_siche_1 FOREIGN KEY (
	sireqNo
)
REFERENCES sireq (
	sireqNo
) ON DELETE CASCADE;
ALTER TABLE siche
ADD CONSTRAINT fk_quoNo
FOREIGN KEY (quoNo)
REFERENCES quotation(quoNo)  ON DELETE CASCADE;
ALTER TABLE siche ADD CONSTRAINT FK_member_TO_siche_1 FOREIGN KEY (
	mid
)
REFERENCES member (
	mid
) ON DELETE CASCADE;



--원데이클래스
CREATE TABLE oneday (
	odNo NUMBER NOT NULL,
	odTitle VARCHAR2(100) NOT NULL,
	odContent VARCHAR2(4000) NOT NULL,
	odName VARCHAR2(100) NOT NULL,
	odDate VARCHAR2(50) NOT NULL,
	odPlace VARCHAR2(100) NOT NULL,
	odTime VARCHAR2(99) NOT NULL,
	odPeople NUMBER NOT NULL,
	odMc VARCHAR2(30) NOT NULL,
	odDeadline VARCHAR2(50) NOT NULL,
	odState NUMBER DEFAULT 0 NOT NULL,
	odWDate DATE DEFAULT SYSDATE NOT NULL,
	odImg VARCHAR2(999) NULL,
	mid VARCHAR2(50) NOT NULL
);

--원데이클래스 신청
CREATE TABLE odReq (
	odReqNo NUMBER NOT NULL,
	odReqTitle VARCHAR2(100) NOT NULL,
	odReqContent VARCHAR2(4000) NOT NULL,
	odReqDate DATE DEFAULT SYSDATE NOT NULL,
	odReqWin NUMBER DEFAULT 0 NOT NULL,
	mid VARCHAR2(50) NOT NULL,
	odNo NUMBER NOT NULL
);

--원데이클래스 리뷰
CREATE TABLE OdReview (
	orNo NUMBER NOT NULL,
	orTitle VARCHAR2(999) NOT NULL,
	orContent VARCHAR2(4000) NOT NULL,
	orDate DATE DEFAULT SYSDATE NOT NULL,
	orHit NUMBER DEFAULT 0 NOT NULL,
	mid VARCHAR2(50) NOT NULL,
	odNo NUMBER NOT NULL
);

--원데이클래스 리뷰 첨부파일
CREATE TABLE OdReviewAttach (
	uuid VARCHAR2(999) NOT NULL,
	upFolder VARCHAR2(999) NOT NULL,
	fileName VARCHAR2(999) NOT NULL,
	orNo NUMBER NOT NULL,
	image NUMBER NULL
);

-- 제품 나눔
CREATE TABLE freePdt (
	fpNo NUMBER NOT NULL,
	fpTitle VARCHAR2(100) NOT NULL,
	fpContent VARCHAR2(4000) NOT NULL,
	freePdt VARCHAR2(999) NOT NULL,
	fpPeople NUMBER NOT NULL,
	fpNowPeople NUMBER DEFAULT 0 NOT NULL,
	fpDeadline VARCHAR2(50) NOT NULL,
	fpState NUMBER DEFAULT 0 NOT NULL,
	fpGetDate VARCHAR2(50) NOT NULL,
	fpGetPlace VARCHAR2(50) NOT NULL,
	fpWDate DATE DEFAULT SYSDATE NOT NULL,
	fpImg VARCHAR2(999) NULL,
	mid VARCHAR2(50) NOT NULL
);


-- 제품 나눔 신청
CREATE TABLE FPReq (
	fpWinNo NUMBER NOT NULL,
	mid VARCHAR2(50) NOT NULL,
	fpNo NUMBER NOT NULL
);

--제품 나눔 리뷰
CREATE TABLE FpReview (
	prNo NUMBER NOT NULL,
	prTitle VARCHAR2(999) NOT NULL,
	prContent VARCHAR2(4000) NOT NULL,
	prDate DATE DEFAULT SYSDATE NOT NULL,
	prHit NUMBER DEFAULT 0 NOT NULL,
	mid VARCHAR2(50) NOT NULL,
	fpNo NUMBER NOT NULL
);

--제품 나눔 리뷰 첨부파일
CREATE TABLE FpReviewAttach (
	uuid VARCHAR2(999) NOT NULL,
	upFolder VARCHAR2(999) NOT NULL,
	fileName VARCHAR2(999) NOT NULL,
	prNo NUMBER NOT NULL,
	image NUMBER NULL
);


--PK 제약조건 설정
ALTER TABLE oneday ADD CONSTRAINT PK_ONEDAY PRIMARY KEY (odNo);
ALTER TABLE odReq ADD CONSTRAINT PK_ODREQ PRIMARY KEY (odReqNo);
ALTER TABLE odReview ADD CONSTRAINT PK_ODREVIEW PRIMARY KEY (orNo);
ALTER TABLE odReviewAttach ADD CONSTRAINT PK_ODREVIEWATTACH PRIMARY KEY (uuid);
ALTER TABLE freePdt ADD CONSTRAINT PK_FREEPDT PRIMARY KEY (fpNo);
ALTER TABLE fpReq ADD CONSTRAINT PK_FPREQ PRIMARY KEY (fpWinNo);
ALTER TABLE fpReview ADD CONSTRAINT PK_FPREVIEW PRIMARY KEY (prNo);
ALTER TABLE fpReviewAttach ADD CONSTRAINT PK_FPREVIEWATTACH PRIMARY KEY (uuid);

--FK 제약조건 설정 : 원데이클래스 (게시글, 신청, 리뷰, 리뷰 첨부파일)

ALTER TABLE oneday ADD CONSTRAINT FK_member_TO_oneday_1 FOREIGN KEY (mid) REFERENCES member (mid) ON DELETE CASCADE;
ALTER TABLE odReq ADD CONSTRAINT FK_member_TO_odReq_1 FOREIGN KEY (mid) REFERENCES member (mid) ON DELETE CASCADE;
ALTER TABLE odReq ADD CONSTRAINT FK_oneday_TO_odReq_1 FOREIGN KEY (odNo) REFERENCES oneday (odNo) ON DELETE CASCADE;
ALTER TABLE OdReview ADD CONSTRAINT FK_member_TO_OdReview_1 FOREIGN KEY (mid) REFERENCES member (mid) ON DELETE CASCADE;
ALTER TABLE OdReview ADD CONSTRAINT FK_oneday_TO_OdReview_1 FOREIGN KEY (odNo) REFERENCES oneday (odNo) ON DELETE CASCADE;
ALTER TABLE OdReviewAttach ADD CONSTRAINT FK_OdR_TO_OdReviewAttach_1 FOREIGN KEY (orNo) REFERENCES OdReview (orNo) ON DELETE CASCADE;


--FK 제약조건 설정 : 제품 나눔 (게시글, 신청, 리뷰, 리뷰 첨부파일)

ALTER TABLE freePdt ADD CONSTRAINT FK_member_TO_freePdt_1 FOREIGN KEY (mid) REFERENCES member (mid) ON DELETE CASCADE;
ALTER TABLE FPReq ADD CONSTRAINT FK_member_TO_FPReq_1 FOREIGN KEY (mid) REFERENCES member (mid) ON DELETE CASCADE;
ALTER TABLE FPReq ADD CONSTRAINT FK_freePdt_TO_FPReq_1 FOREIGN KEY (fpNo) REFERENCES freePdt (fpNo) ON DELETE CASCADE;
ALTER TABLE FpReview ADD CONSTRAINT FK_member_TO_FpReview_1 FOREIGN KEY (mid) REFERENCES member (mid) ON DELETE CASCADE;
ALTER TABLE FpReview ADD CONSTRAINT FK_freePdt_TO_FpReview_1 FOREIGN KEY (fpNo) REFERENCES freePdt (fpNo) ON DELETE CASCADE;
ALTER TABLE FpReviewAttach ADD CONSTRAINT FK_FpR_TO_FpReviewAttach_1 FOREIGN KEY (prNo) REFERENCES FpReview (prNo) ON DELETE CASCADE;

-------시공사례---------
CREATE TABLE showcase (
    scid NUMBER NOT NULL,
    sicheNo NUMBER NOT NULL,
    scTitle VARCHAR2(100) NOT NULL,
    scContent VARCHAR2(500) NOT NULL,
    scrabCnt NUMBER NOT NULL,
    totalrange VARCHAR2(100) NOT NULL,
    sizerange VARCHAR2(50) NULL,
    buildingType VARCHAR2(50) NULL,
    scDate DATE DEFAULT SYSDATE NULL,
    
    CONSTRAINT pk_showcase PRIMARY KEY (scid)
);
ALTER TABLE showcase
ADD CONSTRAINT FK_showcase FOREIGN KEY (sicheNo) REFERENCES siche(sicheNo)  ON DELETE CASCADE;
------시공사례첨부파일-------
CREATE TABLE showcase_Attach (
    uuid VARCHAR2(100) NOT NULL,
    scid NUMBER NOT NULL,
    upfolder VARCHAR2(200) NOT NULL,
    filename VARCHAR2(100) NOT NULL,

    CONSTRAINT pk_showcaseAttach PRIMARY KEY (uuid),
    CONSTRAINT fk_showcaseAttach_scid FOREIGN KEY (scid)
        REFERENCES showcase (scid)
        ON DELETE CASCADE
);
ALTER TABLE showcase_attach ADD isThumbnail number(1,0) default 0;
------스크랩 테이블----------
CREATE TABLE Scrab (
	scrabNum	NUMBER		NOT NULL,
	mid	VARCHAR2(50)	NOT NULL,
	scid	NUMBER		    NOT NULL,
	isVaild	NUMBER(1,0)	DEFAULT 1	NOT NULL,
	
	CONSTRAINT pk_scrab PRIMARY KEY (scrabNum),
	CONSTRAINT fk_scrab_mid FOREIGN KEY (mid)
        REFERENCES member (mid)
	 ON DELETE CASCADE,
 	CONSTRAINT fk_scrab_scid FOREIGN KEY (scid)
        REFERENCES showcase (scid)
	 ON DELETE CASCADE
	
);

